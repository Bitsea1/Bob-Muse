(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7d904e62"],{"03b9":function(t,a,e){},ce7f:function(t,a,e){"use strict";e("03b9")},e86f:function(t,a,e){"use strict";e.r(a);e("149f");var s=e("4ec3"),o=e("1f57"),r=e.n(o),i={data:()=>({data:{},loading:!0,pay_loading:!1,showQrCode:!1,cycle:"month_price",cycle_text:"月付",discount_price:0,price:0,total:0,order_id:0,coupon_code:"",payment:"",showResult:0,payment_method:[],tag_color:["red","orange","purple","green","green","cyan"]}),mounted(){this.order_id=this.$route.params.id,this.getData(this.order_id)},methods:{getData(t){Object(s.o)({trade_no:t}).then(t=>{this.loading=!1,this.data=t.data,this.$emit("changeSpin",!1)}),Object(s.q)().then(t=>{this.payment_method=t.data,t.data&&(this.payment=t.data[0].id)})},pay(){this.pay_loading=!0,Object(s.f)({trade_no:this.order_id,method:this.payment}).then(t=>{this.pay_loading=!1,t.data&&-1===t.type?(this.$message.success("支付成功"),this.getData(this.order_id)):t.data&&1===t.type?(window.clearInterval(),window.location.href=t.data):t.data&&0===t.type?(this.showQrCode=!0,setTimeout(()=>{document.getElementById("qrCode").innerHTML="",new r.a(this.$refs.qrCodeDiv,{text:t.data,width:250,height:250,colorDark:"#333333",colorLight:"#ffffff",correctLevel:r.a.CorrectLevel.L})},100),this.checkOrderInterval(res1.data)):t.data&&-1===t.type&&(this.showResult=!0,window.clearInterval())}).catch(()=>{this.pay_loading=!1})},cancelOrder(t){Object(s.a)({trade_no:t}).then(t=>{t.data&&(this.$message.success("取消成功"),this.$router.push({path:"/order"}))})},checkOrderInterval(t){let a=this;const e=window.setInterval(function(){Object(s.e)({trade_no:t}).then(t=>{t.data&&(a.showQrCode=!1,a.showResult=t.data,clearInterval(e),a.countDown())})},3e3,t)},countDown(){window.clearInterval();let t=5;const a=this.$success({title:"支付成功",content:`前往获取订阅链接(${t}) .`,onOk(){this.$router.push({path:"/subscribe"})}}),e=setInterval(()=>{t-=1,a.update({content:`前往获取订阅链接(${t}) .`})},1e3);setTimeout(()=>{clearInterval(e),a.destroy(),this.$router.push({path:"/subscribe"})},5e3)}},filters:{formatDate:function(t){if(!t)return!1;10===t.toString().length&&(t*=1e3);let a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1;s=s<10?"0"+s:s;let o=a.getDate();o=o<10?"0"+o:o;let r=a.getHours();r=r<10?"0"+r:r;let i=a.getMinutes();i=i<10?"0"+i:i;let c=a.getSeconds();return e+"-"+s+"-"+o+" "+r+":"+i+":"+(c=c<10?"0"+c:c)},money:t=>(t/100).toFixed(2)}},c=(e("ce7f"),e("e607")),n=Object(c.a)(i,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("a-card",{staticClass:"card-order header-solid mb-24 mx-auto mt-20 mb-50",staticStyle:{"max-width":"800px"},attrs:{bordered:!1,bodyStyle:{paddingTop:0}},scopedSlots:t._u([{key:"title",fn:function(){return[e("h6",{staticClass:"mb-0"},[t._v(t._s(t.$t("checkout.text_1")))])]},proxy:!0}])},[0===t.data.status?e("a-button",{staticClass:"px-20",attrs:{slot:"extra",type:"danger",ghost:""},on:{click:function(a){return t.cancelOrder(t.data.trade_no)}},slot:"extra"},[e("a-icon",{staticStyle:{"font-size":"14px"},attrs:{type:"close"}}),t._v(t._s(t.$t("checkout.button_2")))],1):t._e(),e("a-row",{attrs:{gutter:[24],type:"flex"}},[e("a-col",{attrs:{span:24,md:8}},[e("a-descriptions",{attrs:{column:1}},[e("a-descriptions-item",{attrs:{label:t.$t("checkout.text_2")}},[t._v(" "+t._s(t.data.trade_no)+" ")]),e("a-descriptions-item",{attrs:{label:t.$t("checkout.text_3")}},[t._v(" "+t._s(t._f("formatDate")(t.data.created_at))+" ")])],1)],1)],1),e("hr",{staticClass:"gradient-line"}),e("a-row",{staticClass:"order-products",attrs:{gutter:[24],type:"flex",align:"middle"}},[e("a-col",{attrs:{span:24,md:12}},[e("div",{staticClass:"d-flex"},[e("div",[e("h6",{staticClass:"mb-10 mt-10 font-semibold"},[t._v(t._s(t.$t("checkout.text_4")))]),e("a-descriptions",{attrs:{title:"",column:1}},[e("a-descriptions-item",{attrs:{label:t.$t("checkout.text_5")}},[t._v(" "+t._s(t.data.plan.name)+" ")]),e("a-descriptions-item",{attrs:{label:t.$t("checkout.text_6")}},[t._v(" "+t._s(t.$t("plan.period."+t.data.period))+" ")]),e("a-descriptions-item",{attrs:{label:t.$t("checkout.text_7")}},[t._v(" "+t._s(t.data.plan.transfer_enable)+" GB ")])],1)],1)])]),e("a-col",{staticClass:"ml-auto text-right",attrs:{span:24,md:12}},[e("a-tag",{attrs:{color:t.tag_color[t.data.status]}},[t._v(" "+t._s(t.$t("order.table.status_"+t.data.status))+" ")])],1)],1),e("hr",{staticClass:"gradient-line"}),e("a-row",{attrs:{gutter:[24],type:"flex"}},[0===t.data.status?e("a-col",{attrs:{span:24,md:12,lg:10}},[e("h6",{staticClass:"mb-15"},[t._v(t._s(t.$t("checkout.text_15")))]),t._l(t.payment_method,function(a,s){return e("a-card",{key:s,staticClass:"payment-method-card mb-10",class:t.payment==a.id?"payment-checked":"",attrs:{value:a.id},on:{click:function(e){t.payment=a.id}}},[e("a-space",[e("img",{attrs:{src:a.icon,alt:""}}),e("h6",{staticClass:"card-number"},[t._v(t._s(a.name))])])],1)})],2):t._e(),e("a-col",{staticClass:"ml-auto",attrs:{span:24,lg:0===t.data.status?8:24}},[e("h6",{staticClass:"mb-15"},[t._v(t._s(t.$t("checkout.text_11")))]),e("div",{staticClass:"d-flex mb-10"},[e("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t("checkout.text_12"))+": ")]),e("span",{staticClass:"text-lg text-dark font-semibold ml-auto"},[t._v(" ￥"+t._s(t._f("money")(t.data.plan[t.data.period]))+" ")])]),e("div",{staticClass:"d-flex mb-10"},[e("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t("checkout.text_13"))+": ")]),e("span",{staticClass:"text-lg text-dark font-semibold ml-auto"},[t._v(" ￥"+t._s(t._f("money")(t.data.balance_amount))+" ")])]),e("div",{staticClass:"d-flex mb-10"},[e("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t("checkout.text_14"))+": ")]),e("span",{staticClass:"text-lg text-dark font-semibold ml-auto"},[t._v(" ￥"+t._s(t._f("money")(t.data.discount_amount))+" ")])]),e("div",{staticClass:"d-flex mb-24"},[e("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t("checkout.text_16"))+": ")]),e("span",{staticClass:"text-lg text-dark font-semibold ml-auto"},[t._v(" ￥"+t._s(t._f("money")(t.data.surplus_amount))+" ")])]),e("div",{staticClass:"d-flex"},[e("h5",{staticClass:"font-regular text-muted"},[t._v(" "+t._s(t.$t("checkout.text_9"))+": ")]),e("h5",{staticClass:"text-dark font-semibold ml-auto"},[t._v(" ￥"+t._s(t._f("money")(t.data.total_amount))+" ")])])])],1),e("hr",{directives:[{name:"show",rawName:"v-show",value:0===t.data.status,expression:"data.status === 0"}],staticClass:"gradient-line"}),0===t.data.status?e("a-row",{staticClass:"ml-auto",staticStyle:{float:"right"}},[e("a-button",{staticClass:"px-20 mb-10",staticStyle:{width:"300px"},attrs:{type:"primary",loading:t.pay_loading},on:{click:t.pay}},[e("a-icon",{staticStyle:{"font-size":"14px"},attrs:{type:"pay-circle"}}),t._v(t._s(t.$t("checkout.button_1")))],1)],1):t._e()],1),e("a-modal",{attrs:{title:t.$t("plan.text_11"),footer:null},model:{value:t.showQrCode,callback:function(a){t.showQrCode=a},expression:"showQrCode"}},[e("div",{ref:"qrCodeDiv",staticClass:"qrCode",attrs:{id:"qrCode"}})])],1)},[],!1,null,"4136640f",null);a.default=n.exports}}]);