(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d22c895"],{f43d:function(t,e,s){"use strict";s.r(e);var a=s("4ec3"),l={name:"invite",props:{user:{type:Object}},data:()=>({list:[],messageList:[],columns:[{title:"#",dataIndex:"id",scopedSlots:{customRender:"id"}},{slots:{title:"customTitle1"},dataIndex:"subject",scopedSlots:{customRender:"subject"}},{slots:{title:"customTitle2"},dataIndex:"level",scopedSlots:{customRender:"level"}},{slots:{title:"customTitle3"},dataIndex:"status",scopedSlots:{customRender:"status"}},{slots:{title:"customTitle4"},dataIndex:"created_at",scopedSlots:{customRender:"created_at"}},{slots:{title:"customTitle5"},dataIndex:"updated_at",scopedSlots:{customRender:"updated_at"}},{slots:{title:"customTitle6"},dataIndex:"action",fixed:"right",width:130,scopedSlots:{customRender:"action"}}],modal1:!1,modal2:!1,loading:!0,submitting:!1,form:{subject:"",level:0,message:""},reply_text:"",reply_id:"",statusText:["待回复","已关闭"],statusLabel:["warning","success","default","success","warning"]}),mounted(){this.getData()},methods:{getData(){Object(a.y)().then(t=>{this.loading=!1,this.list=t.data,this.$emit("changeSpin",!1)})},onSubmit1(){return this.form.subject?this.form.message?void Object(a.G)(this.form).then(t=>{t.data&&(this.modal1=!1,this.$message.success("提交成功，请等待~"))}):(this.$notification.warning({message:"请输入消息主题内容"}),!1):(this.$notification.warning({message:"请输入主题名称"}),!1)},closeTicket(t){Object(a.g)({id:t}).then(t=>{t.data&&(this.$message.success("关闭成功~"),this.getData())})},replyTicket(){this.submitting=!0,Object(a.B)({id:this.reply_id,message:this.reply_text}).then(t=>{if(this.submitting=!1,t.data){var e=Date.parse(new Date).toString();e=e.substr(0,10),this.messageList=[{is_me:!0,message:this.reply_text,created_at:e},...this.messageList],this.$message.success("回复成功~"),this.getData()}})},showTicket(t){this.reply_id=t,this.modal2=!0,Object(a.z)({id:t}).then(t=>{t.data&&(this.messageList=t.data.message)})}},filters:{formatDate:function(t){if(!t)return!1;10===t.toString().length&&(t*=1e3);let e=new Date(t),s=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;let l=e.getDate();l=l<10?"0"+l:l;let o=e.getHours();o=o<10?"0"+o:o;let i=e.getMinutes();i=i<10?"0"+i:i;let r=e.getSeconds();return s+"-"+a+"-"+l+" "+o+":"+i+":"+(r=r<10?"0"+r:r)}}},o=s("e607"),i=Object(o.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-row",{attrs:{gutter:24}},[s("a-card",[s("a-button",{attrs:{slot:"extra",type:"primary",icon:"plus"},on:{click:function(e){t.modal1=!0}},slot:"extra"},[t._v(t._s(t.$t("ticket.model_1.title")))]),s("a-table",{attrs:{columns:t.columns,"data-source":t.list,loading:t.loading},scopedSlots:t._u([{key:"level",fn:function(e){return s("span",{},[0===e?s("a-badge",{attrs:{rounded:"",type:"primary"}},[t._v(t._s(t.$t("ticket.level_1")))]):1===e?s("a-badge",{attrs:{rounded:"",type:"warning"}},[t._v(t._s(t.$t("ticket.level_2")))]):2===e?s("a-badge",{attrs:{rounded:"",type:"danger"}},[t._v(t._s(t.$t("ticket.level_3")))]):t._e()],1)}},{key:"status",fn:function(e){return s("span",{staticClass:"badge badge-dot"},[s("a-badge",{attrs:{status:t.statusLabel[e]}}),t._v(" "+t._s(t.$t("ticket.table.status_"+e))+" ")],1)}},{key:"created_at",fn:function(e){return s("span",{},[t._v(" "+t._s(t._f("formatDate")(e))+" ")])}},{key:"updated_at",fn:function(e){return s("span",{},[t._v(" "+t._s(t._f("formatDate")(e))+" ")])}},{key:"action",fn:function(e,a){return s("span",{},[s("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return t.showTicket(a.id)}}},[t._v("查看")]),0===a.status?s("a-divider",{attrs:{type:"vertical"}}):t._e(),0===a.status?s("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return t.closeTicket(a.id)}}},[t._v("关闭")]):t._e()],1)}}])},[s("span",{attrs:{slot:"customTitle1"},slot:"customTitle1"},[t._v(t._s(t.$t("ticket.table.title_1")))]),s("span",{attrs:{slot:"customTitle2"},slot:"customTitle2"},[t._v(t._s(t.$t("ticket.table.title_2")))]),s("span",{attrs:{slot:"customTitle3"},slot:"customTitle3"},[t._v(t._s(t.$t("ticket.table.title_3")))]),s("span",{attrs:{slot:"customTitle4"},slot:"customTitle4"},[t._v(t._s(t.$t("ticket.table.title_4")))]),s("span",{attrs:{slot:"customTitle5"},slot:"customTitle5"},[t._v(t._s(t.$t("ticket.table.title_5")))]),s("span",{attrs:{slot:"customTitle6"},slot:"customTitle6"},[t._v(t._s(t.$t("ticket.table.title_6")))])])],1)],1),s("a-modal",{attrs:{title:t.$t("ticket.model_1.title")},on:{ok:t.onSubmit1},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[s("a-form-model",{staticClass:"mt-10",attrs:{layout:"vertical"}},[s("a-form-model-item",{attrs:{label:t.$t("ticket.model_1.text_1")}},[s("a-input",{attrs:{placeholder:t.$t("ticket.model_1.text_1")},model:{value:t.form.subject,callback:function(e){t.$set(t.form,"subject",e)},expression:"form.subject"}})],1),s("a-form-model-item",{attrs:{label:t.$t("ticket.model_1.text_2")}},[s("a-select",{model:{value:t.form.level,callback:function(e){t.$set(t.form,"level",e)},expression:"form.level"}},[s("a-select-option",{attrs:{value:0}},[t._v(t._s(t.$t("ticket.level_1")))]),s("a-select-option",{attrs:{value:1}},[t._v(t._s(t.$t("ticket.level_2")))]),s("a-select-option",{attrs:{value:2}},[t._v(t._s(t.$t("ticket.level_3")))])],1)],1),s("a-form-model-item",{attrs:{label:t.$t("ticket.model_1.text_3")}},[s("a-textarea",{attrs:{placeholder:t.$t("ticket.model_1.text_4"),"auto-size":{minRows:5,maxRows:8}},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],1)],1)],1),s("a-modal",{attrs:{title:t.$t("ticket.model_2.title"),footer:null,"min-width":"50%"},model:{value:t.modal2,callback:function(e){t.modal2=e},expression:"modal2"}},[t.messageList.length?s("a-list",{attrs:{"data-source":t.messageList,header:t.messageList.length+" "+(t.messageList.length>1?"replies":"reply"),"item-layout":"horizontal"},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return s("a-list-item",{},[s("a-comment",{attrs:{datetime:t._f("formatDate")(e.created_at)}},[e.is_me?s("a-avatar",{staticStyle:{color:"#f56a00",backgroundColor:"#fde3cf"},attrs:{slot:"avatar"},slot:"avatar"},[t._v("U")]):s("a-avatar",{staticStyle:{backgroundColor:"#87d068"},attrs:{slot:"avatar",icon:"user"},slot:"avatar"}),s("a",{attrs:{slot:"author"},slot:"author"},[t._v(t._s(e.is_me?"You":"Administrator"))]),s("p",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(e.message))])],1)],1)}}],null,!1,850855453)}):t._e(),s("a-comment",[s("a-avatar",{staticStyle:{color:"#f56a00",backgroundColor:"#fde3cf"},attrs:{slot:"avatar"},slot:"avatar"},[t._v("U")]),s("div",{attrs:{slot:"content"},slot:"content"},[s("a-form-item",[s("a-textarea",{attrs:{rows:4},model:{value:t.reply_text,callback:function(e){t.reply_text=e},expression:"reply_text"}})],1),s("a-form-item",[s("a-button",{attrs:{"html-type":"submit",loading:t.submitting,type:"primary"},on:{click:t.replyTicket}},[s("a-icon",{attrs:{type:"form"}}),t._v(t._s(t.$t("ticket.model_2.button_1"))+" ")],1)],1)],1)],1)],1)],1)},[],!1,null,"6b386434",null);e.default=i.exports}}]);